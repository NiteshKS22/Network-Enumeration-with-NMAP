## MYSQL 

Open-Source SQL relational database management system developed and supported by oracle.

A database with structured collection of data organized fro easy use and retrival. The database is controlled using SQL database language.

It works accourdingly to the client-server priciple.

## MYSQL Client

It can retrive and edit the data using structured quires to database engine, Inserting, deleting, modifying, and retrieving data. it is done using the sql database language.

## MYSQL database

It's ideally suited for appication such as dynamic websites where efficient syntax and high response speed are essentail.
It often combined with apache, linux and PHP is called LAMP(Linux, apache, mysql, php). when used with NGINX it is called LEMP.

MYSQL store passwords in plain text in the schema  for this we can use `one-way encryption` they are generated before-hand.


# Dangerous MySQL Settings

Many things can be misconfigured with MySQL. We can look in more detail at the MySQL reference to determine which options can be made in the server configuration. The main options that are security-relevant are:

## Security-Relevant MySQL Settings

| Setting             | Description                                                                                   |
|---------------------|-----------------------------------------------------------------------------------------------|
| `user`              | Sets which user the MySQL service will run as.                                               |
| `password`          | Sets the password for the MySQL user.                                                        |
| `admin_address`     | The IP address on which to listen for TCP/IP connections on the administrative interface.    |
| `debug`             | Indicates the current debugging settings.                                                    |
| `sql_warnings`      | Controls whether single-row INSERT statements produce an info string if warnings occur.      |
| `secure_file_priv`  | Limits the effect of data import and export operations.                                      |

---

## Plaintext Configuration Risks

The settings `user`, `password`, and `admin_address` are **especially security-relevant** because these entries are often made in **plaintext** within configuration files. If these files are not protected properly (e.g., file permissions misconfigured), an attacker who gains read access — either through file disclosure vulnerabilities or remote shell access — could retrieve the MySQL username and password.

Without any additional security controls in place, an attacker could:

- Access the full database
- View or modify sensitive customer data
- Retrieve email addresses, passwords, and personal information

---

## Verbose Output Risks

The `debug` and `sql_warnings` settings can cause MySQL to **output verbose information** in case of errors. While helpful for administrators, this information:

- May contain sensitive internal logic or structure
- Could expose details that help attackers craft more effective attacks
- Might appear directly in **web application responses**, exposing it publicly

In some cases, this verbose output can even help attackers escalate from SQL injection to executing **system commands** on the MySQL server.

> These risks are covered in more depth in the modules **SQL Injection Fundamentals** and **SQLMap Essentials**.

---

## Footprinting the Service

It’s not uncommon to find **MySQL servers accessible from external networks**, even though this is not a best practice. In many cases:

- External access was configured for temporary testing or as a workaround
- Admins **forgot to restrict access** afterward
- Servers are left exposed due to **misconfigurations**

By default, MySQL listens on **TCP port 3306**, and attackers can use tools like **Nmap** to scan for open MySQL services:

```bash
nmap -p 3306 <target>
```

```
NiteshKS22@htb[/htb]$ mysql -u root -h 10.129.14.132

ERROR 1045 (28000): Access denied for user 'root'@'10.129.14.1' (using password: NO)
```

```
NiteshKS22@htb[/htb]$ mysql -u root -pP4SSw0rd -h 10.129.14.128

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 150165
Server version: 8.0.27-0ubuntu0.20.04.1 (Ubuntu)                                                         
Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.                                     
Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.                           
      
MySQL [(none)]> show databases;                                                                          
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.006 sec)


MySQL [(none)]> select version();
+-------------------------+
| version()               |
+-------------------------+
| 8.0.27-0ubuntu0.20.04.1 |
+-------------------------+
1 row in set (0.001 sec)


MySQL [(none)]> use mysql;
MySQL [mysql]> show tables;
+------------------------------------------------------+
| Tables_in_mysql                                      |
+------------------------------------------------------+
| columns_priv                                         |
| component                                            |
| db                                                   |
| default_roles                                        |
| engine_cost                                          |
| func                                                 |
| general_log                                          |
| global_grants                                        |
| gtid_executed                                        |
| help_category                                        |
| help_keyword                                         |
| help_relation                                        |
| help_topic                                           |
| innodb_index_stats                                   |
| innodb_table_stats                                   |
| password_history                                     |
...SNIP...
| user                                                 |
+------------------------------------------------------+
37 rows in set (0.002 sec)
```

If we look at the existing databases, we will see several already exist. The most important databases for the MySQL server are the system schema (sys) and information schema (information_schema). The system schema contains tables, information, and metadata necessary for management. More about this database can be found in the [reference manual](https://dev.mysql.com/doc/refman/8.0/en/system-schema.html#:~:text=The%20mysql%20schema%20is%20the,used%20for%20other%20operational%20purposes) of MySQL.

```
mysql> use sys;
mysql> show tables;  

+-----------------------------------------------+
| Tables_in_sys                                 |
+-----------------------------------------------+
| host_summary                                  |
| host_summary_by_file_io                       |
| host_summary_by_file_io_type                  |
| host_summary_by_stages                        |
| host_summary_by_statement_latency             |
| host_summary_by_statement_type                |
| innodb_buffer_stats_by_schema                 |
| innodb_buffer_stats_by_table                  |
| innodb_lock_waits                             |
| io_by_thread_by_latency                       |
...SNIP...
| x$waits_global_by_latency                     |
+-----------------------------------------------+


mysql> select host, unique_users from host_summary;

+-------------+--------------+                   
| host        | unique_users |                   
+-------------+--------------+                   
| 10.129.14.1 |            1 |                   
| localhost   |            2 |                   
+-------------+--------------+                   
2 rows in set (0,01 sec)
```

The information schema is also a database that contains metadata. However, this metadata is mainly retrieved from the system schema database. The reason for the existence of these two is the ANSI/ISO standard that has been established. System schema is a Microsoft system catalog for SQL servers and contains much more information than the information schema.

Some of the commands we should remember and write down for working with MySQL databases are described below in the table.

# MySQL Command Reference

| Command                                                           | Description                                                                                                 |
|-------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| `mysql -u <user> -p<password> -h <IP address>`                    | Connect to the MySQL server. There should not be a space between the `-p` flag and the password.           |
| `show databases;`                                                 | Show all databases.                                                                                         |
| `use <database>;`                                                 | Select one of the existing databases.                                                                       |
| `show tables;`                                                    | Show all available tables in the selected database.                                                         |
| `show columns from <table>;`                                      | Show all columns in the selected table.                                                                     |
| `select * from <table>;`                                          | Show everything in the desired table.                                                                       |
| `select * from <table> where <column> = "<string>";`              | Search for a specific string in a particular column of the desired table.                                   |



## QUESTIONS

>**1.  Enumerate the MySQL server and determine the version in use. (Format: MySQL X.X.XX)**

```
nmap -sC -sV -p3306 <IP> --script mysql*
```

>**2. During our penetration test, we found weak credentials "robin:robin". We should try these against the MySQL server. What is the email address of the customer "Otto Lang"?**

```
mysql -u robin -probin -h <IP>


use customers;


show columns from <table name>;


show * from <table name>;

show * from <table name> where name = "Otto Lang";

```
