## VIRTUAL HOSTS

Once the DNS directs traffic to the correct server, the web server config. becomes the crucial in determining how the incoming requests are handled. 

web server like

- Apache
- Nginx
- IIS

  Are designed to host multiple websites or applications on a single server.
they are achive through virtualHost, which allow then to differentiate b/w domains, subdomains or even separate website with distinct content.


## How Virtual Hosts Work: 

Core if Virtual hosting is ability of web servers too distinguish btween multiple websites or applications sharing the same IP address. this is achived by leveraging the HTTP host header, a peice of information included in every HTTP reuest sent by a web browser.

KEY Difference btween `VHost` and `Subdomain` is relationship to DNS and webserver configuration.

- Subdomains : they are extension of a main domain name | they have their own DNS records , pointing to either the same IP address as the main domain or different one

- VHOST : it's configured within a web server that allow multiple websites or applications to be hosted on single server. they can associated with top-level domains or subdomain(dev.example.com) each virtual host can have its own separate config. , enabling precise control over how requests are handled.

if VHOST dont have DNS we can still access it by modifying the hosts file on local machine.

Hosts files are used to map a domain name to an IP address manually, bypassing DNS resolution.


websites have Subdomains that are not public and won't appear in DNS records. these subdomains are only accessible internally or through specific configuration.

VHOST fuzzing is a technique to discover public and non-public subdomains and Vhosts by testing various hostnames against a known IP.

VHOST can be configured to use different domain, not just the sub-doamins.

```
# Example of name-based virtual host configuration in Apache
<VirtualHost *:80>
    ServerName www.example1.com
    DocumentRoot /var/www/example1
</VirtualHost>

<VirtualHost *:80>
    ServerName www.example2.org
    DocumentRoot /var/www/example2
</VirtualHost>

<VirtualHost *:80>
    ServerName www.another-example.net
    DocumentRoot /var/www/another-example
</VirtualHost>
```

## Server Hosting Lookup

<img width="942" height="556" alt="image" src="https://github.com/user-attachments/assets/11f47176-69f2-49e4-aa19-317a2c10be93" />

- Browser Requests a Website: When you enter a domain name (e.g., www.inlanefreight.com) into your browser, it initiates an HTTP request to the web server associated with that domain's IP address.
- Host Header Reveals the Domain: The browser includes the domain name in the request's Host header, which acts as a label to inform the web server which website is being requested.
- Web Server Determines the Virtual Host: The web server receives the request, examines the Host header, and consults its virtual host configuration to find a matching entry for the requested domain name.
- Serving the Right Content: Upon identifying the correct virtual host configuration, the web server retrieves the corresponding files and resources associated with that website from its document root and sends them back to the browser as the HTTP response.

In essence, the Host header functions as a switch, enabling the web server to dynamically determine which website to serve based on the domain name requested by the browser.

## VHOST TYPES

- Name-Based Virtual Hosting: This method relies solely on the HTTP Host header to distinguish between websites. It is the most common and flexible method, as it doesn't require multiple IP addresses. It’s cost-effective, easy to set up, and supports most modern web servers. However, it requires the web server to support name-based virtual hosting and can have limitations with certain protocols like SSL/TLS.
- IP-Based Virtual Hosting: This type of hosting assigns a unique IP address to each website hosted on the server. The server determines which website to serve based on the IP address to which the request was sent. It doesn't rely on the Host header, can be used with any protocol, and offers better isolation between websites. Still, it requires multiple IP addresses, which can be expensive and less scalable.
- Port-Based Virtual Hosting: Different websites are associated with different ports on the same IP address. For example, one website might be accessible on port 80, while another is on port 8080. Port-based virtual hosting can be used when IP addresses are limited, but it’s not as common or user-friendly as name-based virtual hosting and might require users to specify the port number in the URL.



## TOOLS

While manual analysis of HTTP headers and reverse DNS lookups can be effective, specialised virtual host discovery tools automate and streamline the process, making it more efficient and comprehensive. These tools employ various techniques to probe the target server and uncover potential virtual hosts.

| Tool        | Description                                                                 | Features                                                                 |
|-------------|-----------------------------------------------------------------------------|--------------------------------------------------------------------------|
| **gobuster** | A multi-purpose tool often used for directory/file brute-forcing, but also effective for virtual host discovery. | Fast, supports multiple HTTP methods, can use custom wordlists.         |
| **Feroxbuster** | Similar to Gobuster, but with a Rust-based implementation, known for its speed and flexibility. | Supports recursion, wildcard discovery, and various filters.            |
| **ffuf**     | Another fast web fuzzer that can be used for virtual host discovery by fuzzing the Host header. | Customizable wordlist input and filtering options.                      |



### GOBUSTER

```
gobuster vhost -u http://<target_IP_address> -w <wordlist_file> --append-domain
```



##

<img width="973" height="963" alt="image" src="https://github.com/user-attachments/assets/1aca3e52-4458-43f3-8f9a-6a73fd874713" />

##

<img width="808" height="477" alt="image" src="https://github.com/user-attachments/assets/9572bbd4-93f1-44ad-9006-ff3fb03df76a" />

